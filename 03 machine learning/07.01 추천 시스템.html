

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13.1 ì¶”ì²œ ì‹œìŠ¤í…œ &#8212; ë°ì´í„° ì‚¬ì´ì–¸ìŠ¤ ìŠ¤ì¿¨</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "datascienceschool/book");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "ğŸ’¬ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.1 ë¶„ë¥˜ìš© ì˜ˆì œ ë°ì´í„°" href="09.01 ë¶„ë¥˜ìš© ì˜ˆì œ ë°ì´í„°.html" />
    <link rel="prev" title="6.5 ì •ê·œí™” ì„ í˜•íšŒê·€" href="06.05 ì •ê·œí™” ì„ í˜•íšŒê·€.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">ë°ì´í„° ì‚¬ì´ì–¸ìŠ¤ ìŠ¤ì¿¨</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   ë°ì´í„° ì‚¬ì´ì–¸ìŠ¤ ìŠ¤ì¿¨
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  íŒŒì´ì¬ í¸
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/00.00 ì†Œê°œì˜ ê¸€.html">
   ì†Œê°œì˜ ê¸€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/01.00 1ì¥ íŒŒì´ì¬ ì„¤ì¹˜ì™€ ì„¤ì •.html">
   1ì¥ íŒŒì´ì¬ ì„¤ì¹˜ì™€ ì„¤ì •
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.00 2ì¥ íŒŒì´ì¬ ê¸°ì´ˆ ë¬¸ë²•.html">
   2ì¥ íŒŒì´ì¬ ê¸°ì´ˆë¬¸ë²•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/03.00 3ì¥ ë„˜íŒŒì´ ë°°ì—´ í”„ë¡œê·¸ë˜ë°.html">
   3ì¥ ë„˜íŒŒì´ ë°°ì—´ í”„ë¡œê·¸ë˜ë°
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.00 4ì¥ íŒë‹¤ìŠ¤ ë°ì´í„° ë¶„ì„.html">
   4ì¥ íŒë‹¤ìŠ¤ ë°ì´í„° ë¶„ì„
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/05.00 5ì¥ ë°ì´í„° ì‹œê°í™”.html">
   5ì¥ ë°ì´í„° ì‹œê°í™”
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  ìˆ˜í•™ í¸
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/00.00 ì†Œê°œì˜ ê¸€.html">
   ì†Œê°œì˜ ê¸€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/01.00 1ì¥ ìˆ˜í•™ ê¸°í˜¸.html">
   1ì¥ ìˆ˜í•™ ê¸°í˜¸
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/02.00 2ì¥ ë„˜íŒŒì´(NumPy)ë¡œ ê³µë¶€í•˜ëŠ” ì„ í˜•ëŒ€ìˆ˜.html">
   2ì¥ ë„˜íŒŒì´(NumPy)ë¡œ ê³µë¶€í•˜ëŠ” ì„ í˜•ëŒ€ìˆ˜
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/03.00 3ì¥ ê³ ê¸‰ ì„ í˜•ëŒ€ìˆ˜.html">
   3ì¥ ê³ ê¸‰ ì„ í˜•ëŒ€ìˆ˜
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/04.00 4ì¥ ì‹¬íŒŒì´(SymPy)ë¡œ ê³µë¶€í•˜ëŠ” ë¯¸ì ë¶„.html">
   4ì¥ ì‹¬íŒŒì´(SymPy)ë¡œ ê³µë¶€í•˜ëŠ” ë¯¸ì ë¶„
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/05.00 5ì¥ ì‚¬ì´íŒŒì´(SciPy)ë¡œ ê³µë¶€í•˜ëŠ” ìµœì í™”.html">
   5ì¥ ì‚¬ì´íŒŒì´(SciPy)ë¡œ ê³µë¶€í•˜ëŠ” ìµœì í™”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/06.00 6ì¥ í”¼ì§€ì— íŒŒì´(pgmpy)ë¡œ ê³µë¶€í•˜ëŠ” í™•ë¥ ë¡ .html">
   6ì¥ í”¼ì§€ì— íŒŒì´(pgmpy)ë¡œ ê³µë¶€í•˜ëŠ” í™•ë¥ ë¡ 
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/07.00 7ì¥ í™•ë¥ ë³€ìˆ˜ì™€ ìƒê´€ê´€ê³„.html">
   7ì¥ í™•ë¥ ë³€ìˆ˜ì™€ ìƒê´€ê´€ê³„
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/08.00 8ì¥ ì‚¬ì´íŒŒì´ë¡œ ê³µë¶€í•˜ëŠ” í™•ë¥ ë¶„í¬.html">
   8ì¥ ì‚¬ì´íŒŒì´ë¡œ ê³µë¶€í•˜ëŠ” í™•ë¥ ë¶„í¬
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/09.00 9ì¥ ì¶”ì •ê³¼ ê²€ì •.html">
   9ì¥ ì¶”ì •ê³¼ ê²€ì •
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/10.00 10ì¥ ì—”íŠ¸ë¡œí”¼.html">
   10ì¥ ì—”íŠ¸ë¡œí”¼
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  ë¨¸ì‹ ëŸ¬ë‹ í¸
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01.01 ë°ì´í„° ë¶„ì„ì˜ ì†Œê°œ.html">
   1.1 ë°ì´í„° ë¶„ì„ì˜ ì†Œê°œ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.02 ë¨¸ì‹ ëŸ¬ë‹ìš© íŒŒì´ì¬ íŒ¨í‚¤ì§€.html">
   1.2 ë¨¸ì‹ ëŸ¬ë‹ìš© íŒŒì´ì¬ íŒ¨í‚¤ì§€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.01 ë°ì´í„° ì „ì²˜ë¦¬ ê¸°ì´ˆ.html">
   2.1 ë°ì´í„° ì „ì²˜ë¦¬ ê¸°ì´ˆ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.02 ë²”ì£¼í˜• ë°ì´í„° ì²˜ë¦¬.html">
   2.2 ë²”ì£¼í˜• ë°ì´í„° ì²˜ë¦¬
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.01 NLTK ìì—°ì–´ ì²˜ë¦¬ íŒ¨í‚¤ì§€.html">
   NLTK ìì—°ì–´ ì²˜ë¦¬ íŒ¨í‚¤ì§€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.02 KoNLPy í•œêµ­ì–´ ì²˜ë¦¬ íŒ¨í‚¤ì§€.html">
   KoNLPy í•œêµ­ì–´ ì²˜ë¦¬ íŒ¨í‚¤ì§€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.03 Scikit-Learnì˜ ë¬¸ì„œ ì „ì²˜ë¦¬ ê¸°ëŠ¥.html">
   Scikit-Learnì˜ ë¬¸ì„œ ì „ì²˜ë¦¬ ê¸°ëŠ¥
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.04 soynlp.html">
   Soynlp ì†Œê°œ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.05 í™•ë¥ ë¡ ì  ì–¸ì–´ ëª¨í˜•.html">
   í™•ë¥ ë¡ ì  ì–¸ì–´ ëª¨í˜•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.01 ì´ë¯¸ì§€ ì²˜ë¦¬ ê¸°ì´ˆ.html">
   ì´ë¯¸ì§€ ì²˜ë¦¬ ê¸°ì´ˆ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.02 ì´ë¯¸ì§€ í•„í„°ë§.html">
   ì´ë¯¸ì§€ í•„í„°ë§
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.03 ì´ë¯¸ì§€ ì»¨íˆ¬ì–´.html">
   ì´ë¯¸ì§€ ì»¨íˆ¬ì–´
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.04 ì´ë¯¸ì§€ ë³€í™˜.html">
   ì´ë¯¸ì§€ ë³€í™˜
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.05 ì´ë¯¸ì§€ íŠ¹ì§• ì¶”ì¶œ.html">
   ì´ë¯¸ì§€ íŠ¹ì§• ì¶”ì¶œ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.03.01 ì‚¬ìš´ë“œ í”„ë¡œì„¸ì‹± ê¸°ì´ˆ.html">
   ì‚¬ìš´ë“œ í”„ë¡œì„¸ì‹± ê¸°ì´ˆ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.03.02 í‘¸ë¦¬ì— ë³€í™˜ê³¼ ìŠ¤í™íŠ¸ëŸ¼.html">
   í‘¸ë¦¬ì— ë³€í™˜ê³¼ ìŠ¤í™íŠ¸ëŸ¼
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.04.01 ì§€ë¦¬ ì •ë³´ ë°ì´í„° ì²˜ë¦¬.html">
   ì§€ë¦¬ ì •ë³´ ë°ì´í„° ì²˜ë¦¬
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.04.02 ì§€ì˜¤ì½”ë”©.html">
   Geocoding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.01 íšŒê·€ë¶„ì„ ì˜ˆì œ.html">
   4.1 íšŒê·€ë¶„ì„ ì˜ˆì œ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.02 ì„ í˜•íšŒê·€ë¶„ì„ì˜ ê¸°ì´ˆ.html">
   4.2 ì„ í˜•íšŒê·€ë¶„ì„ì˜ ê¸°ì´ˆ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.03 ìŠ¤ì¼€ì¼ë§.html">
   4.3 ìŠ¤ì¼€ì¼ë§
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.04 ë²”ì£¼í˜• ë…ë¦½ë³€ìˆ˜.html">
   4.4 ë²”ì£¼í˜• ë…ë¦½ë³€ìˆ˜
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.05 ë¶€ë¶„íšŒê·€.html">
   4.5 ë¶€ë¶„íšŒê·€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.01 í™•ë¥ ë¡ ì  ì„ í˜• íšŒê·€ëª¨í˜•.html">
   5.1 í™•ë¥ ë¡ ì  ì„ í˜• íšŒê·€ëª¨í˜•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.02 íšŒê·€ë¶„ì„ì˜ ê¸°í•˜í•™.html">
   5.2 íšŒê·€ë¶„ì„ì˜ ê¸°í•˜í•™
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.03 ë ˆë²„ë¦¬ì§€ì™€ ì•„ì›ƒë¼ì´ì–´.html">
   5.3 ë ˆë²„ë¦¬ì§€ì™€ ì•„ì›ƒë¼ì´ì–´
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.04 ë¶„ì‚° ë¶„ì„ê³¼ ëª¨í˜• ì„±ëŠ¥.html">
   5.4 ë¶„ì‚° ë¶„ì„ê³¼ ëª¨í˜• ì„±ëŠ¥
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 ëª¨í˜• ì§„ë‹¨ê³¼ ìˆ˜ì •.html">
   6.1 ëª¨í˜• ì§„ë‹¨ê³¼ ìˆ˜ì •
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 ëª¨í˜• ì§„ë‹¨ê³¼ ìˆ˜ì •.html#id2">
   ì”ì°¨ ì •ê·œì„±
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 ëª¨í˜• ì§„ë‹¨ê³¼ ìˆ˜ì •.html#id3">
   ì”ì°¨ì™€ ë…ë¦½ ë³€ìˆ˜ì˜ ê´€ê³„
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 ëª¨í˜• ì§„ë‹¨ê³¼ ìˆ˜ì •.html#id4">
   ì´ë¶„ì‚°ì„±
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 ëª¨í˜• ì§„ë‹¨ê³¼ ìˆ˜ì •.html#id5">
   ìê¸° ìƒê´€ ê³„ìˆ˜
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.02 ê¸°ì €í•¨ìˆ˜ ëª¨í˜•ê³¼ ê³¼ìµœì í™”.html">
   6.2 ê¸°ì €í•¨ìˆ˜ ëª¨í˜•ê³¼ ê³¼ìµœì í™”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.03 êµì°¨ê²€ì¦.html">
   6.3 êµì°¨ê²€ì¦
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.04 ë‹¤ì¤‘ê³µì„ ì„±ê³¼ ë³€ìˆ˜ ì„ íƒ.html">
   6.4 ë‹¤ì¤‘ê³µì„ ì„±ê³¼ ë³€ìˆ˜ ì„ íƒ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.04 ë‹¤ì¤‘ê³µì„ ì„±ê³¼ ë³€ìˆ˜ ì„ íƒ.html#vif">
   VIF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.04 ë‹¤ì¤‘ê³µì„ ì„±ê³¼ ë³€ìˆ˜ ì„ íƒ.html#id2">
   ë³´ìŠ¤í„´ ì§‘ê°’ ì˜ˆì¸¡ ë¬¸ì œì— ì‘ìš©
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.05 ì •ê·œí™” ì„ í˜•íšŒê·€.html">
   6.5 ì •ê·œí™” ì„ í˜•íšŒê·€
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   13.1 ì¶”ì²œ ì‹œìŠ¤í…œ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.01 ë¶„ë¥˜ìš© ì˜ˆì œ ë°ì´í„°.html">
   5.1 ë¶„ë¥˜ìš© ì˜ˆì œ ë°ì´í„°
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 ë¶„ë¥˜ìš© ê°€ìƒ ë°ì´í„° ìƒì„±.html">
   5.2 ë¶„ë¥˜ìš© ê°€ìƒ ë°ì´í„° ìƒì„±
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 ë¶„ë¥˜ìš© ê°€ìƒ ë°ì´í„° ìƒì„±.html#make-blobs">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_blobs
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 ë¶„ë¥˜ìš© ê°€ìƒ ë°ì´í„° ìƒì„±.html#make-moons">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_moons
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 ë¶„ë¥˜ìš© ê°€ìƒ ë°ì´í„° ìƒì„±.html#make-gaussian-quantiles">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_gaussian_quantiles
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.03 ë¶„ë¥˜ëª¨í˜•.html">
   5.3 ë¶„ë¥˜ëª¨í˜•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.04 ë¶„ë¥˜ ì„±ëŠ¥í‰ê°€.html">
   5.4 ë¶„ë¥˜ ì„±ëŠ¥í‰ê°€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10.01 ë¡œì§€ìŠ¤í‹± íšŒê·€ë¶„ì„.html">
   6.1 ë¡œì§€ìŠ¤í‹± íšŒê·€ë¶„ì„
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.01 ì„ í˜•íŒë³„ë¶„ì„ë²•ê³¼ ì´ì°¨íŒë³„ë¶„ì„ë²•.html">
   7.1 ì„ í˜•íŒë³„ë¶„ì„ë²•ê³¼ ì´ì°¨íŒë³„ë¶„ì„ë²•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.02 ë‚˜ì´ë¸Œë² ì´ì¦ˆ ë¶„ë¥˜ëª¨í˜•.html">
   7.2 ë‚˜ì´ë¸Œë² ì´ì¦ˆ ë¶„ë¥˜ëª¨í˜•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.03 ê°ì„± ë¶„ì„.html">
   ê°ì„± ë¶„ì„
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.01 ì˜ì‚¬ê²°ì •ë‚˜ë¬´.html">
   8.1 ì˜ì‚¬ê²°ì •ë‚˜ë¬´
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.02 ëª¨í˜• ê²°í•©.html">
   12.02 ëª¨í˜• ê²°í•©
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.03 ë¶€ìŠ¤íŒ… ë°©ë²•.html">
   ë¶€ìŠ¤íŒ… ë°©ë²•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13.02 ì„œí¬íŠ¸ ë²¡í„° ë¨¸ì‹ .html">
   ì„œí¬íŠ¸ ë²¡í„° ë¨¸ì‹ 
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13.03 ì»¤ë„ ì„œí¬íŠ¸ ë²¡í„° ë¨¸ì‹ .html">
   ì»¤ë„ ì„œí¬íŠ¸ ë²¡í„° ë¨¸ì‹ 
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.01 ëª¨í˜• ìµœì í™”.html">
   ëª¨í˜• ìµœì í™”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.02 ë¹„ëŒ€ì¹­ ë°ì´í„° ë¬¸ì œ.html">
   ë¹„ëŒ€ì¹­ ë°ì´í„° ë¬¸ì œ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.03 íŠ¹ì§• ì„ íƒ.html">
   íŠ¹ì§• ì„ íƒ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.04 ëŒ€ê·œëª¨ ë°ì´í„° í•™ìŠµ.html">
   ëŒ€ê·œëª¨ ë°ì´í„° í•™ìŠµ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.01 êµ°ì§‘í™”.html">
   êµ°ì§‘í™”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.02 K-í‰ê·  êµ°ì§‘í™”.html">
   K-í‰ê·  êµ°ì§‘í™”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.03 ë””ë¹„ìŠ¤ìº” êµ°ì§‘í™”.html">
   ë””ë¹„ìŠ¤ìº” êµ°ì§‘í™”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.04 ê³„ì¸µì  êµ°ì§‘í™”.html">
   ê³„ì¸µì  êµ°ì§‘í™”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.05 Affinity Propagation.html">
   Affinity Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.01 ê·¸ë˜í”„ ì´ë¡  ê¸°ì´ˆ.html">
   ê·¸ë˜í”„ ì´ë¡  ê¸°ì´ˆ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.02 ê·¸ë˜í”„ í™•ë¥ ëª¨í˜•.html">
   ê·¸ë˜í”„ í™•ë¥ ëª¨í˜•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.03 ë„¤íŠ¸ì›Œí¬ ì¶”ë¡ .html">
   ë„¤íŠ¸ì›Œí¬ ì¶”ë¡ 
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18.01 ê°€ìš°ì‹œì•ˆ í˜¼í•©ëª¨í˜•ê³¼ EM ë°©ë²•.html">
   ê°€ìš°ì‹œì•ˆ í˜¼í•©ëª¨í˜•ê³¼ EM ë°©ë²•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18.02 ë³€ë¶„ë²•ì  ì¶”ë¡ .html">
   ë³€ë¶„ë²•ì  ì¶”ë¡ 
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19.01 ëª¬í…Œì¹´ë¥¼ë¡œ ë² ì´ì§€ì•ˆ ë¶„ì„.html">
   ëª¬í…Œì¹´ë¥¼ë¡œ ë² ì´ì§€ì•ˆ ë¶„ì„
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19.02 ë² ì´ì§€ì•ˆ íšŒê·€ ë¶„ì„ ì˜ˆì œ.html">
   ë² ì´ì§€ì•ˆ íšŒê·€ ë¶„ì„ ì˜ˆì œ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="20.01 íˆë“  ë§ˆì½”í”„ ëª¨í˜•.html">
   íˆë“  ë§ˆì½”í”„ ëª¨í˜•
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/03 machine learning/07.01 ì¶”ì²œ ì‹œìŠ¤í…œ.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/03 machine learning/07.01 ì¶”ì²œ ì‹œìŠ¤í…œ.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/03 machine learning/07.01 ì¶”ì²œ ì‹œìŠ¤í…œ.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#surprise">
   Surprise íŒ¨í‚¤ì§€
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   í‰ì  ë°ì´í„°
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   ì¶”ì²œ ì‹œìŠ¤í…œ ì•Œê³ ë¦¬ì¦˜
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   ë² ì´ìŠ¤ë¼ì¸ ëª¨í˜•
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   ëª¨í˜• ì‚¬ìš©ë²•
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   ì¶”ì²œì„±ëŠ¥ í‰ê°€ê¸°ì¤€
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#collaborative-filter">
   Collaborative Filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#neighborhood">
   Neighborhood ëª¨í˜•
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   ìœ ì‚¬ë„ ê³„ì‚°
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   í‰ê· ì œê³±ì°¨ì´ ìœ ì‚¬ë„
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   ì½”ì‚¬ì¸ ìœ ì‚¬ë„
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   í”¼ì–´ìŠ¨ ìœ ì‚¬ë„
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id11">
   í”¼ì–´ìŠ¨-ë² ì´ìŠ¤ë¼ì¸ ìœ ì‚¬ë„
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#knn">
   KNN ê°€ì¤‘ì¹˜ ì˜ˆì¸¡ ë°©ë²•
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#latent-factor">
   Latent Factor ëª¨í˜•
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrix-factorization">
   Matrix Factorization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#svd-singular-value-decomposition">
   SVD (Singular Value Decomposition)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nmf-non-negative-matrix-factorization">
   NMF(Non-negative matrix factorization)
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>13.1 ì¶”ì²œ ì‹œìŠ¤í…œ<a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h1>
<p>ì¶”ì²œ ì‹œìŠ¤í…œ(recommender system)ì´ë€ ì‚¬ìš©ì(user)ê°€ ì„ í˜¸í•˜ëŠ” ìƒí’ˆ(item)ì„ ì˜ˆì¸¡í•˜ëŠ” ì‹œìŠ¤í…œì´ë‹¤.</p>
<p>Amazonê³¼ ê°™ì€ ì¸í„°ë„· ì‡¼í•‘ ì‚¬ì´íŠ¸ë‚˜ Netflix ë“±ì˜ ì˜¨ë¼ì¸ ë¹„ë””ì˜¤ ì½˜í…ì¸  ì œê³µ ì‚¬ì´íŠ¸ëŠ” ì‚¬ìš©ìê°€ ê°ê°ì˜ ìƒí’ˆì— ëŒ€í•´ í‰ê°€í•œ í‰ì (rate)ì„ ê°€ì§€ê³  ìˆë‹¤. ì´ ê¸°ë¡ì„ ê¸°ë°˜ìœ¼ë¡œ í•´ì„œ ì‚¬ìš©ìì—ê²Œ ì–´ë–¤ ìƒí’ˆì„ ì¶”ì²œí• ì§€ ì˜ˆì¸¡í•˜ê²Œ ëœë‹¤.</p>
<div class="section" id="surprise">
<h2>Surprise íŒ¨í‚¤ì§€<a class="headerlink" href="#surprise" title="Permalink to this headline">Â¶</a></h2>
<p>íŒŒì´ì¬ì˜ SurpriseíŒ¨í‚¤ì§€ëŠ” ë‹¤ì–‘í•œ ì¶”ì²œ ì‹œìŠ¤í…œ ì•Œê³ ë¦¬ì¦˜ì„ ì œê³µí•œë‹¤.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">surprise</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>í‰ì  ë°ì´í„°<a class="headerlink" href="#id2" title="Permalink to this headline">Â¶</a></h2>
<p>surprise íŒ¨í‚¤ì§€ì—ì„œëŠ” MovieLenseë¼ëŠ” ì˜í™” ì¶”ì²œ ì›¹ì‚¬ì´íŠ¸ì˜ ë°ì´í„°ë¥¼ ìƒ˜í”Œ í‰ì  ë°ì´í„°ë¡œ ì œê³µí•œë‹¤. MovieLense ë°ì´í„° ì¤‘ 10ë§Œê°œì˜ ìƒ˜í”Œ ë°ì´í„°ì„¸íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë¡œë“œí•œë‹¤.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">surprise</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">load_builtin</span><span class="p">(</span><span class="s1">&#39;ml-100k&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>ì´ ë°ì´í„°ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•  ìˆ˜ ìˆë‹¤.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">raw_ratings</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">,</span> <span class="s2">&quot;rate&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">])</span>
<span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user</th>
      <th>item</th>
      <th>rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>196</td>
      <td>242</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>186</td>
      <td>302</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>377</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>244</td>
      <td>51</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>166</td>
      <td>346</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>298</td>
      <td>474</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>115</td>
      <td>265</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>253</td>
      <td>465</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>305</td>
      <td>451</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>6</td>
      <td>86</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>ì—¬ê¸°ì—ì„œ user ì—´ì€ ì‚¬ìš©ì ì•„ì´ë””, item ì—´ì€ ìƒí’ˆ ì•„ì´ë””, rate ì—´ì€ í‰ì ì´ë‹¤. ì¦‰, 196ë²ˆ ì‚¬ìš©ìëŠ” 242ë²ˆ ì˜í™”ì— ëŒ€í•´ í‰ì  3ì ì„ ì£¼ì—ˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>
<p>ì´ ë°ì´í„°í”„ë ˆì„ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´</p>
<blockquote>
<div><p><strong>ì¶”ì²œ ì‹œìŠ¤í…œì€ ì‚¬ìš©ì ì•„ì´ë””ì™€ ìƒí’ˆ ì•„ì´ë””ë¼ëŠ” ë‘ ê°œì˜ ì¹´í…Œê³ ë¦¬ ì…ë ¥ê³¼ í‰ì  ì¶œë ¥ì„ ê°€ì§€ëŠ” ì˜ˆì¸¡ ì‹œìŠ¤í…œ</strong></p>
</div></blockquote>
<p>ì´ë‹¤.</p>
<p>ì´ ë°ì´í„°ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ í”¼ë´‡í…Œì´ë¸”(pivot table) í˜•íƒœë¡œ ë§Œë“¤ë©´ xì¶•ì´ ìƒí’ˆ, yì¶•ì´ ì‚¬ìš©ì ì•„ì´ë””ì¸ í‰ì  í–‰ë ¬(rate matrix) <span class="math notranslate nohighlight">\(R\)</span> ì´ ëœë‹¤.</p>
<p>í‰ì  í–‰ë ¬ <span class="math notranslate nohighlight">\(R\)</span>ì˜ í–‰ì€ íŠ¹ì • ì‚¬ìš©ìì˜ í‰ì ì´ê³  í‰ì  í–‰ë ¬ <span class="math notranslate nohighlight">\(R\)</span>ì˜ ì—´ì€ íŠ¹ì • ìƒí’ˆì˜ í‰ì ì´ë‹¤.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_table</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">df_table</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(943, 1682)
</pre></div>
</div>
</div>
</div>
<p>ì´ í‰ì  í–‰ë ¬ì˜ ì¼ë¶€ë§Œ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ í‰ì  ë°ì´í„°ê°€ ì¼ë¶€ ìœ„ì¹˜ì—ë§Œ ì¡´ì¬í•˜ëŠ” sparse í–‰ë ¬ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">212</span><span class="p">:</span><span class="mi">222</span><span class="p">,</span> <span class="mi">808</span><span class="p">:</span><span class="mi">817</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="9" halign="left">rate</th>
    </tr>
    <tr>
      <th>item</th>
      <th>211</th>
      <th>212</th>
      <th>213</th>
      <th>214</th>
      <th>215</th>
      <th>216</th>
      <th>217</th>
      <th>218</th>
      <th>219</th>
    </tr>
    <tr>
      <th>user</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>290</th>
      <td>3</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>4</td>
      <td></td>
      <td>2</td>
      <td></td>
    </tr>
    <tr>
      <th>291</th>
      <td></td>
      <td>4</td>
      <td></td>
      <td>4</td>
      <td>4</td>
      <td></td>
      <td></td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>292</th>
      <td></td>
      <td></td>
      <td></td>
      <td>3</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>293</th>
      <td>4</td>
      <td></td>
      <td>3</td>
      <td></td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td></td>
    </tr>
    <tr>
      <th>294</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>295</th>
      <td></td>
      <td></td>
      <td>5</td>
      <td></td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td></td>
    </tr>
    <tr>
      <th>296</th>
      <td>4</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>297</th>
      <td>4</td>
      <td></td>
      <td>3</td>
      <td></td>
      <td>2</td>
      <td>4</td>
      <td></td>
      <td>3</td>
      <td></td>
    </tr>
    <tr>
      <th>298</th>
      <td>5</td>
      <td></td>
      <td>3</td>
      <td></td>
      <td>5</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>299</th>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td></td>
      <td></td>
      <td>5</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>í‰ì  í–‰ë ¬ì˜ ë¹ˆì¹¸ì„ í°ìƒ‰, ì ìˆ˜ë¥¼ ê²€ì€ìƒ‰ìœ¼ë¡œ ì‹œê°í™” í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">df_table</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Rate Matrix&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/07.01 ì¶”ì²œ ì‹œìŠ¤í…œ_17_0.png" src="../_images/07.01 ì¶”ì²œ ì‹œìŠ¤í…œ_17_0.png" />
</div>
</div>
</div>
<div class="section" id="id3">
<h2>ì¶”ì²œ ì‹œìŠ¤í…œ ì•Œê³ ë¦¬ì¦˜<a class="headerlink" href="#id3" title="Permalink to this headline">Â¶</a></h2>
<p>ì¶”ì²œ ì‹œìŠ¤í…œì€ ë‘ ê°œì˜ ì¹´í…Œê³ ë¦¬ ê°’ ì…ë ¥ì—ì„œ í•˜ë‚˜ì˜ ì‹¤ìˆ˜ ê°’ ì¶œë ¥ì„ ì˜ˆì¸¡í•˜ëŠ” íšŒê·€ ëª¨í˜•ì´ì§€ë§Œ ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì˜ˆì¸¡ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê³  ìˆë‹¤. ì¶”ì²œ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©ë˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ol class="simple">
<li><p>ë² ì´ìŠ¤ë¼ì¸ ëª¨í˜•</p></li>
<li><p>Collaborative Filtering</p></li>
</ol>
<ul class="simple">
<li><p>2-1. Neighborhood Models</p>
<ul>
<li><p>User-based CF</p></li>
<li><p>Item-based CF</p></li>
</ul>
</li>
<li><p>2-2. Latent Factor Models</p>
<ul>
<li><p>Matrix Factorization</p></li>
<li><p>SVD</p></li>
</ul>
</li>
</ul>
<ol class="simple">
<li><p>Content-Based Recommendation</p></li>
</ol>
</div>
<div class="section" id="id4">
<h2>ë² ì´ìŠ¤ë¼ì¸ ëª¨í˜•<a class="headerlink" href="#id4" title="Permalink to this headline">Â¶</a></h2>
<p>ë² ì´ìŠ¤ë¼ì¸ ëª¨í˜•(baseline model)ì€ ì‚¬ìš©ì ì•„ì´ë”” <span class="math notranslate nohighlight">\(u\)</span>, ìƒí’ˆ ì•„ì´ë”” <span class="math notranslate nohighlight">\(i\)</span>, ë‘ ê°œì˜ ì¹´í…Œê³ ë¦¬ ê°’ ì…ë ¥ì—ì„œ í‰ì  <span class="math notranslate nohighlight">\(r(u,i)\)</span>ì˜ ì˜ˆì¸¡ì¹˜ <span class="math notranslate nohighlight">\(\hat{r}(u,i)\)</span>  ì„ ì˜ˆì¸¡í•˜ëŠ” ê°€ì¥ ë‹¨ìˆœí•œ íšŒê·€ë¶„ì„ëª¨í˜•ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©ìì™€ ìƒí’ˆ íŠ¹ì„±ì— ì˜í•œ í‰ê·  í‰ì ì˜ í•©ìœ¼ë¡œ ë‚˜íƒ€ë‚œë‹¤.</p>
<div class="math notranslate nohighlight">
\[ \hat{r}(u,i) = \mu + b(u) + b(i) \]</div>
<p>ì´ ì‹ì—ì„œ <span class="math notranslate nohighlight">\(\mu\)</span>ëŠ” ì „ì²´ í‰ì ì˜ í‰ê· ì´ê³ , <span class="math notranslate nohighlight">\(b(u)\)</span>ëŠ” ë™ì¼í•œ ì‚¬ìš©ìì— ì˜í•œ í‰ì  ì¡°ì •ê°’,  <span class="math notranslate nohighlight">\(b(i)\)</span>ëŠ” ë™ì¼í•œ ìƒí’ˆì— ëŒ€í•œ í‰ì  ì¡°ì •ê°’ì´ë‹¤.</p>
<p>ë² ì´ìŠ¤ë¼ì¸ ëª¨í˜•ì€ ë‹¤ìŒ ì˜¤ì°¨ í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ë„ë¡ êµ¬í•´ì§„ë‹¤.</p>
<div class="math notranslate nohighlight">
\[ \sum_{u,i \in R_{train}} \left(r(u,i) - \hat{r}(u,i))\right)^2 \]</div>
<p>ì—¬ê¸°ì—ì„œ <span class="math notranslate nohighlight">\(R_{train}\)</span>ëŠ” ì‹¤ì œ í‰ì ì´ ì¡´ì¬í•˜ëŠ” í•™ìŠµìš© ë°ì´í„° ì§‘í•©ì´ë‹¤.</p>
<p>ê³¼ìµœì í™”ë¥¼ í”¼í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ ì •ê·œí™” í•­ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.</p>
<div class="math notranslate nohighlight">
\[ \sum_{u,i \in R_{train}} \left(r(u,i) - \hat{r}(u,i))\right)^2 + \lambda \left(b(u)^2 + b(i)^2 \right) \]</div>
<p>surprise íŒ¨í‚¤ì§€ëŠ” ì˜¤ì°¨ í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ë‘ ê°€ì§€ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì„ ì œê³µí•œë‹¤. ì•Œê³ ë¦¬ì¦˜ì˜ ì„ íƒì€ <code class="docutils literal notranslate"><span class="pre">method</span></code> ì¸ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¼ ë‚˜ë¨¸ì§€ ìµœì í™” ì¸ìˆ˜ê°€ ë‹¬ë¼ì§„ë‹¤.</p>
<ul class="simple">
<li><p>SGD (Stochastic Gradient Descent)ì˜ ì¸ìˆ˜</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">reg</span></code>: ì •ê·œí™” ê°€ì¤‘ì¹˜. ë””í´íŠ¸ëŠ” 0.02.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">learning_rate</span></code>: ìµœì í™” ìŠ¤í… ì‚¬ì´ì¦ˆ. ë””í´íŠ¸ëŠ” 0.005.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_epochs</span></code>: ìµœì í™” ë°˜ë³µ íšŸìˆ˜. ë””í´íŠ¸ëŠ”  20.</p></li>
</ul>
</li>
<li><p>ALS (Alternating Least Squares)ì˜ ì¸ìˆ˜</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">reg_i</span></code>: ìƒí’ˆì— ëŒ€í•œ ì •ê·œí™” ê°€ì¤‘ì¹˜. ë””í´íŠ¸ëŠ” 10.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reg_u</span></code>: ì‚¬ìš©ìì— ëŒ€í•œ ì •ê·œí™” ê°€ì¤‘ì¹˜. ë””í´íŠ¸ëŠ” 15.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_epochs</span></code>: ìµœì í™” ë°˜ë³µ íšŸìˆ˜. ë””í´íŠ¸ëŠ” 10.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id5">
<h2>ëª¨í˜• ì‚¬ìš©ë²•<a class="headerlink" href="#id5" title="Permalink to this headline">Â¶</a></h2>
<p>ë² ì´ìŠ¤ë¼ì¸ ëª¨í˜•ì„ ë¹„ë¡¯í•œ surprise íŒ¨í‚¤ì§€ ëª¨í˜•ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ìˆœì„œë¥¼ ê±°ì¹œë‹¤.</p>
<ol class="simple">
<li><p>ë°ì´í„°ì„¸íŠ¸ì˜ <code class="docutils literal notranslate"><span class="pre">split</span></code>,  <code class="docutils literal notranslate"><span class="pre">folds</span></code> ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ K-Fold íŠ¸ë ˆì´ë‹ ë°ì´í„°ì…‹ê³¼ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì„ ë§Œë“ ë‹¤.</p></li>
<li><p>ëª¨í˜• ì•Œê³ ë¦¬ì¦˜ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.</p></li>
<li><p>ëª¨í˜• ì•Œê³ ë¦¬ì¦˜ ê°ì²´ì˜ <code class="docutils literal notranslate"><span class="pre">train</span></code> ë©”ì„œë“œì™€ íŠ¸ë ˆì´ë‹ ë°ì´í„°ì…‹ìœ¼ë¡œ ëª¨ìˆ˜ë¥¼ ì¶”ì •í•œ í›„, <code class="docutils literal notranslate"><span class="pre">test</span></code> ë©”ì„œë“œë¡œ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì˜ˆì¸¡ì„ ì‹¤ì‹œí•œë‹¤.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">accuracy</span></code> ì„œë¸ŒíŒ¨í‚¤ì§€ì˜ ì„±ëŠ¥í‰ê°€ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ì„±ëŠ¥ì„ ê³„ì‚°í•œë‹¤.</p></li>
</ol>
<p>ì´ ê³¼ì •ì€ <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> ëª…ë ¹ìœ¼ë¡œ ë‹¨ì¶•í•  ìˆ˜ë„ ìˆë‹¤.</p>
<p>surprise íŒ¨í‚¤ì§€ëŠ” ë² ì´ìŠ¤ë¼ì¸ ëª¨í˜•ì„ ìœ„í•œ <code class="docutils literal notranslate"><span class="pre">BaselineOnly</span></code> í´ë˜ìŠ¤ë¥¼ ì œê³µí•œë‹¤.</p>
<p>ìš°ì„  ë² ì´ìŠ¤ë¼ì¸ ëª¨í˜•ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ MovieLens ë°ì´í„°ë¥¼ ì²˜ë¦¬í•´ ë³´ì. FCP(Fraction of Concordant Pairs)ë¡œ ê³„ì‚°í•œ í‰ê°€ ì ìˆ˜ëŠ” ì•½ 0.70ì ì´ë‹¤.</p>
</div>
<div class="section" id="id6">
<h2>ì¶”ì²œì„±ëŠ¥ í‰ê°€ê¸°ì¤€<a class="headerlink" href="#id6" title="Permalink to this headline">Â¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">accuracy</span></code> ì„œë¸ŒíŒ¨í‚¤ì§€ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì¶”ì²œì„±ëŠ¥ í‰ê°€ê¸°ì¤€ì„ ì œê³µí•œë‹¤. ì´ ì‹ì—ì„œ <span class="math notranslate nohighlight">\(\hat{R}\)</span>ì€ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì„ ëœ»í•œë‹¤.</p>
<ul class="simple">
<li><p>RMSE (Root Mean Squared Error)
$<span class="math notranslate nohighlight">\( \text{RMSE} = \sqrt{\frac{1}{|\hat{R}|} \sum_{\hat{r}(u,i) \in \hat{R}}(r(u,i) - \hat{r}(u,i))^2} \)</span>$</p></li>
<li><p>MAE (Mean Absolute Error)
$<span class="math notranslate nohighlight">\( \text{MAE} = \dfrac{1}{|\hat{R}|} \sum_{\hat{r}(u,i) \in \hat{R}}|r(u,i) - \hat{r}(u,i)| \)</span>$</p></li>
<li><p>FCP (Fraction of Concordant Pairs)
$<span class="math notranslate nohighlight">\( \text{FCP} = \dfrac{\text{number of concordant pairs}}{\text{number of discordant pairs}} \)</span>$</p></li>
</ul>
<p>íšŒê·€ ë¶„ì„ì—ì„œ <span class="math notranslate nohighlight">\(i\)</span>ë²ˆì§¸ ë°ì´í„°ì™€ <span class="math notranslate nohighlight">\(j\)</span>ë²ˆì§¸ ë°ì´í„°ì— ëŒ€í•´ ì‹¤ì œ ë°ì´í„° <span class="math notranslate nohighlight">\(y_i, y_j\)</span>ì™€ ì˜ˆì¸¡ ë°ì´í„° <span class="math notranslate nohighlight">\(\hat{y}_i, \hat{y}_j\)</span> ì‚¬ì´ì˜ ì¦ê°€ ë°©í–¥ì´ ê°™ìœ¼ë©´ condordant pairë¼ê³  í•œë‹¤.</p>
<div class="math notranslate nohighlight">
\[ \text{sign}(y_i - y_j) = \text{sign}(\hat{y}_i - \hat{y}_j) \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">surprise.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>

<span class="n">bsl_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;als&#39;</span><span class="p">,</span>
    <span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s1">&#39;reg_u&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
    <span class="s1">&#39;reg_i&#39;</span><span class="p">:</span> <span class="mi">5</span>
<span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">surprise</span><span class="o">.</span><span class="n">BaselineOnly</span><span class="p">(</span><span class="n">bsl_options</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
    <span class="n">algo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">testset</span><span class="p">)</span>
    <span class="n">acc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">surprise</span><span class="o">.</span><span class="n">accuracy</span><span class="o">.</span><span class="n">rmse</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">acc</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimating biases using als...
RMSE: 0.9453
Estimating biases using als...
RMSE: 0.9377
Estimating biases using als...
RMSE: 0.9500
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9443304984013942
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cross_validate</span></code> ëª…ë ¹ì„ ì‚¬ìš©í•˜ë©´ ìœ„ ì½”ë“œë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ë‹¨ì¶•í•  ìˆ˜ ìˆë‹¤.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">surprise.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>

<span class="n">cross_validate</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimating biases using als...
Estimating biases using als...
Estimating biases using als...
Estimating biases using als...
Estimating biases using als...
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;test_rmse&#39;: array([0.9384446 , 0.94651657, 0.93612815, 0.94221861, 0.94428787]),
 &#39;test_mae&#39;: array([0.74477853, 0.75124267, 0.73975393, 0.745764  , 0.74659098]),
 &#39;fit_time&#39;: (0.10585212707519531,
  0.13820195198059082,
  0.1485898494720459,
  0.13920855522155762,
  0.11656451225280762),
 &#39;test_time&#39;: (0.21303677558898926,
  0.12261795997619629,
  0.20620155334472656,
  0.12421703338623047,
  0.1168220043182373)}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="collaborative-filter">
<h2>Collaborative Filter<a class="headerlink" href="#collaborative-filter" title="Permalink to this headline">Â¶</a></h2>
<p>CF(Collaborative Filter) ë°©ë²•ì€ ëª¨ë“  ì‚¬ìš©ìì˜ ë°ì´í„°ë¥¼ ê· ì¼í•˜ê²Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í‰ì  í–‰ë ¬ì´ ê°€ì§„ íŠ¹ì •í•œ íŒ¨í„´ì„ ì°¾ì•„ì„œ ì´ë¥¼ í‰ì  ì˜ˆì¸¡ì— ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤. CF ë°©ë²•ë„ ì‚¬ìš©ìë‚˜ ìƒí’ˆ ê¸°ì¤€ìœ¼ë¡œ í‰ì ì˜ ìœ ì‚¬ì„±ì„ ì‚´í”¼ëŠ” Neighborhood ëª¨í˜•ê³¼ í–‰ë ¬ì˜ ìˆ˜ì¹˜ì  íŠ¹ì§•ì„ ì´ìš©í•˜ëŠ” Latent Factor ëª¨í˜•ì´ ìˆë‹¤.</p>
</div>
<div class="section" id="neighborhood">
<h2>Neighborhood ëª¨í˜•<a class="headerlink" href="#neighborhood" title="Permalink to this headline">Â¶</a></h2>
<p>Neighborhood ëª¨í˜•ì€ Memory-based CFë¼ê³ ë„ í•œë‹¤. ì´ ë°©ë²•ì€ íŠ¹ì • ì‚¬ìš©ìì˜ í‰ì ì„ ì˜ˆì¸¡í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ì•„ë‹ˆë¼ í•´ë‹¹ ì‚¬ìš©ìì™€ ìœ ì‚¬í•œ(similar) ì‚¬ìš©ìì— ëŒ€í•´ ê°€ì¤‘ì¹˜ë¥¼ ì¤€ë‹¤.</p>
<p>íŠ¹íˆ í•´ë‹¹ ì‚¬ìš©ìì™€ ìœ ì‚¬í•œ ì‚¬ìš©ìë¥¼ ì°¾ëŠ” ë°©ë²• ì¦‰, í‰ì  í–‰ë ¬ì—ì„œ ìœ ì‚¬í•œ ì‚¬ìš©ì í–‰ ë²¡í„°ë¥¼ ì°¾ì•„ì„œ ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¹ˆ ë°ì´í„°ë¥¼ ê³„ì‚°í•˜ëŠ” ë°©ë²•ì„ <strong>ì‚¬ìš©ì ê¸°ë°˜ (User-based) CF</strong>ë¼ê³  í•œë‹¤.</p>
<p>ì´ì™€ ë‹¬ë¦¬ íŠ¹ì •í•œ ìƒí’ˆì— ëŒ€í•´ ì‚¬ìš©ìê°€ ì¤€ ì ìˆ˜ ì¦‰, í‰ì  í–‰ë ¬ì˜ ìƒí’ˆ ì—´ ë²¡í„°ì˜ ìœ ì‚¬ì„±ì„ ì°¾ê³  íŠ¹ì • ìƒí’ˆê³¼ ìœ ì‚¬í•œ í‰ì  ì •ë³´ë¥¼ ê°€ì§€ëŠ” ìƒí’ˆë“¤ë¡œ í•´ë‹¹ ìƒí’ˆì˜ ë¹ˆ ë°ì´í„°ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë°©ë²•ì„ <strong>ìƒí’ˆ ê¸°ë°˜ (Item-based) CF</strong>ë¼ê³  í•œë‹¤.</p>
</div>
<div class="section" id="id7">
<h2>ìœ ì‚¬ë„ ê³„ì‚°<a class="headerlink" href="#id7" title="Permalink to this headline">Â¶</a></h2>
<p>ì‚¬ìš©ì íŠ¹ì„± ë²¡í„°(í‰ì  í–‰ë ¬ì˜ í–‰ ë²¡í„°)ì´ë‚˜ ìƒí’ˆ íŠ¹ì„± ë²¡í„°(í‰ì  í–‰ë ¬ì˜ ì—´ ë²¡í„°)ì˜ ìœ ì‚¬ë„(similarity)ì„ ë¹„êµí•˜ê¸° ìœ„í•œ ê¸°ì¤€ë„ ì—¬ëŸ¬ê°€ì§€ê°€ ìˆì„ ìˆ˜ ìˆë‹¤.</p>
<p>surprise íŒ¨í‚¤ì§€ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ìœ ì‚¬ë„ ê¸°ì¤€ì„ ì œê³µí•œë‹¤.</p>
<ul class="simple">
<li><p>í‰ê· ì œê³±ì°¨ì´ ìœ ì‚¬ë„ (Mean Squared Difference Similarity)</p></li>
<li><p>ì½”ì‚¬ì¸ ìœ ì‚¬ë„ (Cosine Similarity)</p></li>
<li><p>í”¼ì–´ìŠ¨ ìœ ì‚¬ë„ (Pearson Similarity)</p></li>
<li><p>í”¼ì–´ìŠ¨-ë² ì´ìŠ¤ë¼ì¸ ìœ ì‚¬ë„ (Pearson-Baseline Similarity)</p></li>
</ul>
<p>surprise íŒ¨í‚¤ì§€ì˜ ìœ ì‚¬ë„ ì„¤ì • ì˜µì…˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: ì‚¬ìš©í•  ìœ ì‚¬ë„ì˜ ì¢…ë¥˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ìì—´. ë””í´íŠ¸ëŠ” <code class="docutils literal notranslate"><span class="pre">'MSD'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">user_based</span></code>: <code class="docutils literal notranslate"><span class="pre">True</span></code>ë©´ ì‚¬ìš©ì ê¸°ë°˜, <code class="docutils literal notranslate"><span class="pre">False</span></code>ë©´ ìƒí’ˆ ê¸°ë°˜.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_support</span></code>: ë‘ ì‚¬ìš©ìë‚˜, ìƒí’ˆì—ì„œ ê³µí†µì ìœ¼ë¡œ ìˆëŠ” í‰ì  ì›ì†Œì˜ ìˆ˜ì˜ ìµœì†Ÿê°’. ê³µí†µ í‰ì  ì›ì†Œì˜ ìˆ˜ê°€ ì´ ê°’ë³´ë‹¤ ì ìœ¼ë©´ í•´ë‹¹ ë²¡í„°ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ë””í´íŠ¸ëŠ”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shrinkage</span></code>: Shrinkage ê°€ì¤‘ì¹˜. ë””í´íŠ¸ëŠ” 100.</p></li>
</ul>
</div>
<div class="section" id="id8">
<h2>í‰ê· ì œê³±ì°¨ì´ ìœ ì‚¬ë„<a class="headerlink" href="#id8" title="Permalink to this headline">Â¶</a></h2>
<p>í‰ê· ì œê³±ì°¨ì´(Mean Squared Difference, MSD)ìœ ì‚¬ë„ëŠ” ìœ í´ë¦¬ë“œ ê³µê°„ì—ì„œì˜ ê±°ë¦¬ ì œê³±ì— ë¹„ë¡€í•˜ëŠ” ê°’ì´ë‹¤. ì¼ë‹¨ ë‹¤ìŒê³¼ ê°™ì´ msdê°’ì„ êµ¬í•˜ê³  ê·¸ ì—­ìˆ˜ë¡œ ìœ ì‚¬ë„ë¥¼ ì •ì˜í•œë‹¤. msdê°’ì´ 0ì´ ë˜ëŠ” ê²½ìš°ë¥¼ ëŒ€ë¹„í•˜ì—¬ 1ì„ ë”í•´ì¤€ë‹¤.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{split}\text{msd_sim}(u, v) &amp;= \frac{1}{\text{msd}(u, v) + 1}\\
\text{msd_sim}(i, j) &amp;= \frac{1}{\text{msd}(i, j) + 1}\end{split} \end{split}\]</div>
<ul class="simple">
<li><p>ì‚¬ìš©ì <span class="math notranslate nohighlight">\(u\)</span>ì™€ ì‚¬ìš©ì <span class="math notranslate nohighlight">\(v\)</span>ê°„ì˜ msd</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \text{msd}(u, v) = \frac{1}{|I_{uv}|} \cdot \sum\limits_{i \in I_{uv}} (r(u,i) - r_(v,i))^2 \]</div>
<p>ìœ„ ì‹ì—ì„œ <span class="math notranslate nohighlight">\(I_{uv}\)</span>ëŠ” ì‚¬ìš©ì <span class="math notranslate nohighlight">\(u\)</span>ì™€ ì‚¬ìš©ì <span class="math notranslate nohighlight">\(v\)</span> ëª¨ë‘ì— ì˜í•´ í‰ê°€ëœ ìƒí’ˆì˜ ì§‘í•©ì´ê³  <span class="math notranslate nohighlight">\(|I_{uv}|\)</span>ëŠ” ì‚¬ìš©ì <span class="math notranslate nohighlight">\(u\)</span>ì™€ ì‚¬ìš©ì <span class="math notranslate nohighlight">\(v\)</span> ëª¨ë‘ì— ì˜í•´ í‰ê°€ëœ ìƒí’ˆì˜ ìˆ˜</p>
<ul class="simple">
<li><p>ìƒí’ˆ <span class="math notranslate nohighlight">\(i\)</span>ì™€ ìƒí’ˆ <span class="math notranslate nohighlight">\(j\)</span>ê°„ì˜ msd</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \text{msd}(i, j) = \frac{1}{|U_{ij}|} \cdot \sum\limits_{u \in U_{ij}} (r(u,i) - r(u,j))^2 \]</div>
<p>ìœ„ ì‹ì—ì„œ <span class="math notranslate nohighlight">\(U_{ij}\)</span>ëŠ” ìƒí’ˆ <span class="math notranslate nohighlight">\(i\)</span>ì™€ ìƒí’ˆ <span class="math notranslate nohighlight">\(j\)</span> ëª¨ë‘ë¥¼ í‰ê°€í•œ ì‚¬ìš©ìì˜ ì§‘í•©ì´ê³  <span class="math notranslate nohighlight">\(|U_{ij}|\)</span>ëŠ” ìƒí’ˆ <span class="math notranslate nohighlight">\(i\)</span>ì™€ ìƒí’ˆ <span class="math notranslate nohighlight">\(j\)</span> ëª¨ë‘ë¥¼ í‰ê°€í•œ ì‚¬ìš©ìì˜ ìˆ˜</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;msd&#39;</span><span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">surprise</span><span class="o">.</span><span class="n">KNNBasic</span><span class="p">(</span><span class="n">sim_options</span><span class="o">=</span><span class="n">sim_options</span><span class="p">)</span>
<span class="n">cross_validate</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="s2">&quot;test_mae&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing the msd similarity matrix...
Done computing similarity matrix.
Computing the msd similarity matrix...
Done computing similarity matrix.
Computing the msd similarity matrix...
Done computing similarity matrix.
Computing the msd similarity matrix...
Done computing similarity matrix.
Computing the msd similarity matrix...
Done computing similarity matrix.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7726801901092284
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id9">
<h2>ì½”ì‚¬ì¸ ìœ ì‚¬ë„<a class="headerlink" href="#id9" title="Permalink to this headline">Â¶</a></h2>
<p>ì½”ì‚¬ì¸ ìœ ì‚¬ë„(Cosine Similarity)ëŠ” ë‘ íŠ¹ì„± ë²¡í„°ì˜ ê°ë„ì— ëŒ€í•œ ì½”ì‚¬ì¸ ê°’ì„ ë§í•œë‹¤. ë²¡í„° <span class="math notranslate nohighlight">\(x\)</span>ì™€ ë²¡í„° <span class="math notranslate nohighlight">\(y\)</span> ì‚¬ì´ì˜ ê°ë„ <span class="math notranslate nohighlight">\(\theta\)</span> ëŠ” ë‘ ë²¡í„°ì˜ ë‚´ì  <span class="math notranslate nohighlight">\(x \cdot y\)</span>ì™€ ë‹¤ìŒê³¼ ê°™ì€ ê´€ê³„ê°€ ìˆë‹¤. ê°ë„ <span class="math notranslate nohighlight">\(\theta\)</span>ê°€ 0ë„ì´ë©´ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ëŠ” 1ì´ë‹¤. ë°˜ëŒ€ë¡œ ê°ë„ <span class="math notranslate nohighlight">\(\theta\)</span>ê°€ 90ë„ì´ë©´ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ëŠ” 0ì´ë‹¤.</p>
<div class="math notranslate nohighlight">
\[ x \cdot y = |x| |y| \cos\theta \]</div>
<div class="math notranslate nohighlight">
\[ \cos\theta = \dfrac{x \cdot y}{|x| |y|}\]</div>
<ul class="simple">
<li><p>ì‚¬ìš©ì <span class="math notranslate nohighlight">\(u\)</span>ì™€ ì‚¬ìš©ì <span class="math notranslate nohighlight">\(v\)</span>ê°„ì˜ ì½”ì‚¬ì¸ ìœ ì‚¬ë„</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ 
\text{cosine_sim}(u, v) = \frac{
\sum\limits_{i \in I_{uv}} r(u,i) \cdot r(v,i)}
{\sqrt{\sum\limits_{i \in I_{uv}} r(u,i)^2} \cdot
\sqrt{\sum\limits_{i \in I_{uv}} r(v,i)^2}
}
\]</div>
<ul class="simple">
<li><p>ìƒí’ˆ <span class="math notranslate nohighlight">\(i\)</span>ì™€ ìƒí’ˆ <span class="math notranslate nohighlight">\(j\)</span>ê°„ì˜ ì½”ì‚¬ì¸ ìœ ì‚¬ë„</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ 
\text{cosine_sim}(i, j) = \frac{
\sum\limits_{u \in U_{ij}} r(u,i) \cdot r(u,j)}
{\sqrt{\sum\limits_{u \in U_{ij}} r(u,i)^2} \cdot
\sqrt{\sum\limits_{u \in U_{ij}} r(u,j)^2}
} 
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;cosine&#39;</span><span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">surprise</span><span class="o">.</span><span class="n">KNNBasic</span><span class="p">(</span><span class="n">sim_options</span><span class="o">=</span><span class="n">sim_options</span><span class="p">)</span>
<span class="n">cross_validate</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="s2">&quot;test_mae&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing the cosine similarity matrix...
Done computing similarity matrix.
Computing the cosine similarity matrix...
Done computing similarity matrix.
Computing the cosine similarity matrix...
Done computing similarity matrix.
Computing the cosine similarity matrix...
Done computing similarity matrix.
Computing the cosine similarity matrix...
Done computing similarity matrix.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8046567723959086
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id10">
<h2>í”¼ì–´ìŠ¨ ìœ ì‚¬ë„<a class="headerlink" href="#id10" title="Permalink to this headline">Â¶</a></h2>
<p>í”¼ì–´ìŠ¨ ìœ ì‚¬ë„(Pearson Similarity)ëŠ” ë‘ ë²¡í„°ì˜ ìƒê´€ê³„ìˆ˜(Pearson correlation coefficient)ë¥¼ ë§í•˜ë©° ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•œë‹¤.</p>
<ul class="simple">
<li><p>ì‚¬ìš©ì <span class="math notranslate nohighlight">\(u\)</span>ì™€ ì‚¬ìš©ì <span class="math notranslate nohighlight">\(v\)</span>ê°„ì˜ í”¼ì–´ìŠ¨ ìœ ì‚¬ë„</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \text{pearson_sim}(u, v) = \frac{
\sum\limits_{i \in I_{uv}} (r(u,i) -  \mu(u)) \cdot (r(v,i) - \mu(v))}
{\sqrt{\sum\limits_{i \in I_{uv}} (r(u,i) -  \mu(u))^2} \cdot
\sqrt{\sum\limits_{i \in I_{uv}} (r(v,i) -  \mu(v))^2}
} \]</div>
<p>ìœ„ ì‹ì—ì„œ <span class="math notranslate nohighlight">\(\mu(u)\)</span>ëŠ” ì‚¬ìš©ì <span class="math notranslate nohighlight">\(u\)</span>ì˜ í‰ê·  í‰ì ì´ë‹¤.</p>
<ul class="simple">
<li><p>ìƒí’ˆ <span class="math notranslate nohighlight">\(i\)</span>ì™€ ìƒí’ˆ <span class="math notranslate nohighlight">\(j\)</span>ê°„ì˜ í”¼ì–´ìŠ¨ ìœ ì‚¬ë„</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{pearson_sim}(i, j) = \frac{
\sum\limits_{u \in U_{ij}} (r(u,i) -  \mu(i)) \cdot (r(u,j) - \mu(j))}
{\sqrt{\sum\limits_{u \in U_{ij}} (r(u,i) -  \mu(i))^2} \cdot
\sqrt{\sum\limits_{u \in U_{ij}} (r(u,j) -  \mu(j))^2}
}
\]</div>
<p>ìœ„ ì‹ì—ì„œ <span class="math notranslate nohighlight">\(\mu(i)\)</span>ëŠ” ìƒí’ˆ <span class="math notranslate nohighlight">\(i\)</span>ì˜ í‰ê·  í‰ì ì´ë‹¤.</p>
<p>ìƒê´€ê³„ìˆ˜ëŠ” ê°€ì¥ ë†’ì€ ê²½ìš°ì˜ ê°’ì´ 1ì´ê³  ë¬´ìƒê´€ì¸ ê²½ìš°ì—ëŠ” 0ì´ë‹¤.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;pearson&#39;</span><span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">surprise</span><span class="o">.</span><span class="n">KNNBasic</span><span class="p">(</span><span class="n">sim_options</span><span class="o">=</span><span class="n">sim_options</span><span class="p">)</span>
<span class="n">cross_validate</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="s2">&quot;test_mae&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing the pearson similarity matrix...
Done computing similarity matrix.
Computing the pearson similarity matrix...
Done computing similarity matrix.
Computing the pearson similarity matrix...
Done computing similarity matrix.
Computing the pearson similarity matrix...
Done computing similarity matrix.
Computing the pearson similarity matrix...
Done computing similarity matrix.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8032778978216127
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id11">
<h2>í”¼ì–´ìŠ¨-ë² ì´ìŠ¤ë¼ì¸ ìœ ì‚¬ë„<a class="headerlink" href="#id11" title="Permalink to this headline">Â¶</a></h2>
<p>í”¼ì–´ìŠ¨-ë² ì´ìŠ¤ë¼ì¸(Pearson-Baseline Similarity) ìœ ì‚¬ë„ëŠ” í”¼ì–´ìŠ¨-ë² ì´ìŠ¤ë¼ì¸ ìœ ì‚¬ë„ì™€ ê°™ì´ ìƒê´€ê³„ìˆ˜ë¥¼ êµ¬í•˜ì§€ë§Œ ê° ë²¡í„°ì˜ ê¸°ëŒ“ê°’ì„ ë‹¨ìˆœ í‰ê· ì´ ì•„ë‹ˆë¼ ë² ì´ìŠ¤ë¼ì¸ ëª¨í˜•ì—ì„œ ì˜ˆì¸¡í•œ ê°’ì„ ì‚¬ìš©í•œë‹¤.</p>
<ul class="simple">
<li><p>ì‚¬ìš©ì <span class="math notranslate nohighlight">\(u\)</span>ì™€ ì‚¬ìš©ì <span class="math notranslate nohighlight">\(v\)</span>ê°„ì˜ msd</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ 
\text{pearson_baseline_sim}(u, v) = \hat{\rho}_{uv} = \frac{
\sum\limits_{i \in I_{uv}} (r(u,i) -  b(u,i)) \cdot (r(v,i) - b(v,i))}
{\sqrt{\sum\limits_{i \in I_{uv}} (r(u,i) -  b(u,i))^2} \cdot
\sqrt{\sum\limits_{i \in I_{uv}} (r(v,i) -  b(v,i))^2}} 
\]</div>
<ul class="simple">
<li><p>ìƒí’ˆ <span class="math notranslate nohighlight">\(i\)</span>ì™€ ìƒí’ˆ <span class="math notranslate nohighlight">\(j\)</span>ê°„ì˜ msd</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{pearson_baseline_sim}(i, j) = \hat{\rho}_{ij} = \frac{
\sum\limits_{u \in U_{ij}} (r(u,i) -  b(u,i)) \cdot (r(u,j) - b(u,j))}
{\sqrt{\sum\limits_{u \in U_{ij}} (r(u,i) -  b(u,i))^2} \cdot
\sqrt{\sum\limits_{u \in U_{ij}} (r(u,j) -  b(u,j))^2}}
\]</div>
<p>í”¼ì–´ìŠ¨-ë² ì´ìŠ¤ë¼ì¸ ìœ ì‚¬ë„ëŠ” ë²¡í„°ì˜ ì°¨ì› ì¦‰, ë‘ ì‚¬ìš©ìë‚˜ ìƒí’ˆì— ê³µí†µì ìœ¼ë¡œ ìˆëŠ” í‰ì  ì›ì†Œì˜ ê°¯ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ì •ê·œí™”ë¥¼ í•˜ëŠ” shrinkageë¥¼ ì¶”ê°€í•˜ì—¬ ì‚¬ìš©í•œë‹¤.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{split}\text{pearson_baseline_shrunk_sim}(u, v) &amp;= \frac{|I_{uv}| - 1}
{|I_{uv}| - 1 + \text{shrinkage}} \cdot \hat{\rho}_{uv}\end{split} 
\]</div>
<div class="math notranslate nohighlight">
\[ \begin{split}\text{pearson_baseline_shrunk_sim}(i, j) &amp;= \frac{|U_{ij}| - 1}
{|U_{ij}| - 1 + \text{shrinkage}} \cdot \hat{\rho}_{ij}\end{split} 
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;pearson_baseline&#39;</span><span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">surprise</span><span class="o">.</span><span class="n">KNNBasic</span><span class="p">(</span><span class="n">sim_options</span><span class="o">=</span><span class="n">sim_options</span><span class="p">)</span>
<span class="n">cross_validate</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="s2">&quot;test_mae&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.791677323191221
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="knn">
<h2>KNN ê°€ì¤‘ì¹˜ ì˜ˆì¸¡ ë°©ë²•<a class="headerlink" href="#knn" title="Permalink to this headline">Â¶</a></h2>
<p>ì¼ë‹¨ ìœ ì‚¬ë„ê°€ êµ¬í•´ì§€ë©´ í‰ì ì„ ì˜ˆì¸¡í•˜ê³ ì í•˜ëŠ” ì‚¬ìš©ì(ë˜ëŠ” ìƒí’ˆ)ì™€ ìœ ì‚¬ë„ê°€ í° <span class="math notranslate nohighlight">\(k\)</span>ê°œì˜ ì‚¬ìš©ì(ë˜ëŠ” ìƒí’ˆ) ë²¡í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°€ì¤‘ í‰ê· ì„ êµ¬í•´ì„œ ê°€ì¤‘ì¹˜ë¥¼ ì˜ˆì¸¡í•œë‹¤. ì´ëŸ¬í•œ ë°©ë²•ì„ KNN(K Nearest Neighbors) ê¸°ë°˜ ì˜ˆì¸¡ ë°©ë²•ì´ë¼ê³  í•œë‹¤.</p>
<p>surprise íŒ¨í‚¤ì§€ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ 3ê°€ì§€ì˜ KNN ê¸°ë°˜ ê°€ì¤‘ì¹˜ ì˜ˆì¸¡ ì•Œê³ ë¦¬ì¦˜ í´ë˜ìŠ¤ë¥¼ ì œê³µí•œë‹¤.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">KNNBasic</span></code></p>
<ul>
<li><p>í‰ì ë“¤ì„ ë‹¨ìˆœíˆ ê°€ì¤‘ í‰ê· í•œë‹¤. ë‹¤ìŒ ì‹ì—ì„œ <span class="math notranslate nohighlight">\(N^k\)</span>ëŠ” <span class="math notranslate nohighlight">\(k\)</span>ê°œì˜ ê°€ì¥ ìœ ì‚¬ë„ê°€ í° ë²¡í„°ì˜ ì§‘í•©ì´ë‹¤.</p></li>
</ul>
</li>
</ul>
<div class="math notranslate nohighlight">
\[  
\hat{r}(u,i) = \frac{
        \sum\limits_{v \in N^k_i(u)} \text{sim}(u, v) \cdot r(v,i)}
        {\sum\limits_{v \in N^k_i(u)} \text{sim}(u, v)}
\]</div>
<p>ë˜ëŠ”
$<span class="math notranslate nohighlight">\(
\hat{r}(u,i) = \frac{
        \sum\limits_{j \in N^k_u(i)} \text{sim}(i, j) \cdot r(u,j)}
        {\sum\limits_{j \in N^k_u(j)} \text{sim}(i, j)}
\)</span>$</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">KNNWithMeans</span></code></p>
<ul>
<li><p>í‰ì ë“¤ì„ í‰ê· ê°’ ê¸°ì¤€ìœ¼ë¡œ ê°€ì¤‘ í‰ê· í•œë‹¤.</p></li>
</ul>
</li>
</ul>
<div class="math notranslate nohighlight">
\[  
\hat{r}(u,i) = \mu(u) + 
\frac{\sum\limits_{v \in N^k_i(u)} \text{sim}(u, v) \cdot (r(v,i) - \mu(v))}{\sum\limits_{v \in N^k_i(u)} \text{sim}(u, v)}
\]</div>
<p>ë˜ëŠ”</p>
<div class="math notranslate nohighlight">
\[
\hat{r}(u,i) = \mu(i) + 
\frac{\sum\limits_{j \in N^k_u(i)}\text{sim}(i, j) \cdot (r(u,j) - \mu(j))} {\sum\limits_{j \in N^k_u(i)} \text{sim}(i, j)}
\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">KNNBaseline</span></code></p>
<ul>
<li><p>í‰ì ë“¤ì„ ë² ì´ìŠ¤ë¼ì¸ ëª¨í˜•ì˜ ê°’ ê¸°ì¤€ìœ¼ë¡œ ê°€ì¤‘ í‰ê· í•œë‹¤.</p></li>
</ul>
</li>
</ul>
<div class="math notranslate nohighlight">
\[  
\hat{r}(u,i) = b(u,i) + \frac{ \sum\limits_{v \in N^k_i(u)}
\text{sim}(u, v) \cdot (r(v,i) - b(v,i))} {\sum\limits_{v \in
N^k_i(u)} \text{sim}(u, v)}
\]</div>
<p>ë˜ëŠ”
$<span class="math notranslate nohighlight">\(
\hat{r}(u,i) = b(u,i) + \frac{ \sum\limits_{j \in N^k_u(i)}
\text{sim}(i, j) \cdot (r(u,j) - b(u,j))} {\sum\limits_{j \in
N^k_u(j)} \text{sim}(i, j)}
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;pearson_baseline&#39;</span><span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">surprise</span><span class="o">.</span><span class="n">KNNWithMeans</span><span class="p">(</span><span class="n">sim_options</span><span class="o">=</span><span class="n">sim_options</span><span class="p">)</span>
<span class="n">cross_validate</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="s2">&quot;test_mae&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7299485648439766
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;pearson_baseline&#39;</span><span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">surprise</span><span class="o">.</span><span class="n">KNNBaseline</span><span class="p">(</span><span class="n">sim_options</span><span class="o">=</span><span class="n">sim_options</span><span class="p">)</span>
<span class="n">cross_validate</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="s2">&quot;test_mae&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
Estimating biases using als...
Computing the pearson_baseline similarity matrix...
Done computing similarity matrix.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7211170375266851
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="latent-factor">
<h2>Latent Factor ëª¨í˜•<a class="headerlink" href="#latent-factor" title="Permalink to this headline">Â¶</a></h2>
<p>ì‚¬ìš©ìì˜ íŠ¹ì„± ë²¡í„°ë‚˜ ìƒí’ˆì˜ íŠ¹ì„± ë²¡í„°ì˜ ê¸¸ì´ëŠ” ìˆ˜ì²œì—ì„œ ìˆ˜ì‹­ì–µì— ë‹¬í•˜ëŠ” ê¸´ í¬ê¸°ê°€ ë  ìˆ˜ë„ ìˆë‹¤.</p>
<p>Latent Factor ëª¨í˜•ì€ ì´ë ‡ê²Œ ê¸´ ì‚¬ìš©ì íŠ¹ì„±ì´ë‚˜ ìƒí’ˆ íŠ¹ì„±ì„ ëª‡ ê°œì˜ ìš”ì¸ ë²¡í„°ë¡œ ê°„ëµí™”(approximate)í•  ìˆ˜ ìˆë‹¤ëŠ” ê°€ì •ì—ì„œ ì¶œë°œí•œ ëª¨í˜•ì´ë‹¤.<br />
PCA(Principle Component Analysis)ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸´ íŠ¹ì„± ë²¡í„°ë¥¼ ì†Œìˆ˜ì˜ ì°¨ì›ìœ¼ë¡œ ì°¨ì› ì¶•ì†Œí•  ìˆ˜ ìˆë“¯ì´ ì‚¬ìš©ìì˜ íŠ¹ì„±ë„ ì°¨ì› ì¶•ì†Œ í•  ìˆ˜ ìˆë‹¤.</p>
<p>ì˜í™”ì— ëŒ€í•œ í‰ì ì„ ì£¼ëŠ” ê²½ìš°, ì½”ë¯¸ë””, ì•¡ì…˜, ë“œë¼ë§ˆ ë“± ëª‡ê°œì˜ ì¥ë¥´ ìš”ì¸ì´ ìˆì–´ì„œ ì‚¬ìš©ìëŠ” íŠ¹ì •í•œ ì¥ë¥´ ìš”ì†Œì— ëŒ€í•´ ë” ì ìˆ˜ë¥¼ ë§ì´ ì£¼ê±°ë‚˜ ì ê²Œ ì¤„ ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ì˜í™” ìì²´ë„ ì´ëŸ¬í•œ ì¥ë¥´ ìš”ì¸ì„ ê°€ì§€ê³  ìˆë‹¤ë©´ í•´ë‹¹ ì‚¬ìš©ìì˜ ê·¸ ì˜í™”ì— ëŒ€í•œ í‰ì ì€ ì‚¬ìš©ìì˜ ì¥ë¥´ ìš”ì¸ ë²¡í„°ì™€ ì˜í™”ì˜ ì¥ë¥´ ìš”ì¸ ë²¡í„°ì˜ ë‚´ì ìœ¼ë¡œ í‘œì‹œí•  ìˆ˜ ìˆë‹¤.</p>
<p>ì˜ˆë¥¼ ë“¤ì–´ ì•¡ì…˜ì„ ì‹«ì–´í•˜ê³ (-1) ì½”ë¯¸ë””(2)ë‚˜ ë“œë¼ë§ˆ(3)ë¥¼ ì¢‹ì•„í•˜ëŠ” ì‚¬ìš©ìì˜ ìš”ì¸ ë²¡í„°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="math notranslate nohighlight">
\[ p(u)^T = (-1, 2, 3) \]</div>
<p>ì–´ë–¤ ì˜í™”ê°€ ì•¡ì…˜ ìš”ì†Œê°€ 2ì´ê³  ì½”ë¯¸ë”” ìš”ì†Œê°€ 1ì´ê³ , ë“œë¼ë§ˆ ìš”ì†Œê°€ 1ì´ë¼ë©´</p>
<div class="math notranslate nohighlight">
\[ q(i)^T = (2, 1, 1) \]</div>
<p>í‰ì ì€ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤.</p>
<div class="math notranslate nohighlight">
\[ r(u,i) = q(i)^Tp(u) = -1 \cdot 2 + 2 \cdot 1 + 3 \cdot 1 = 3\]</div>
</div>
<div class="section" id="matrix-factorization">
<h2>Matrix Factorization<a class="headerlink" href="#matrix-factorization" title="Permalink to this headline">Â¶</a></h2>
<p>Matrix Factorization ë°©ë²•ì€ ëª¨ë“  ì‚¬ìš©ìì™€ ìƒí’ˆì— ëŒ€í•´ ë‹¤ìŒ ì˜¤ì°¨ í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” ìš”ì¸ ë²¡í„°ë¥¼ ì°¾ì•„ë‚¸ë‹¤. ì¦‰ ë‹¤ìŒê³¼ ê°™ì€ í–‰ë ¬ <span class="math notranslate nohighlight">\(P\)</span>, <span class="math notranslate nohighlight">\(Q\)</span>ë¥¼ ì°¾ëŠ”ë‹¤.</p>
<div class="math notranslate nohighlight">
\[ R \approx PQ^T  \]</div>
<p>ì—¬ê¸°ì—ì„œ</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R \in \mathbf{R}^{m \times n}\)</span> : <span class="math notranslate nohighlight">\(m\)</span> ì‚¬ìš©ìì™€ <span class="math notranslate nohighlight">\(n\)</span> ìƒí’ˆì˜ í‰ì  í–‰ë ¬</p></li>
<li><p><span class="math notranslate nohighlight">\(P \in \mathbf{R}^{m \times k}\)</span> : <span class="math notranslate nohighlight">\(m\)</span> ì‚¬ìš©ìì™€ <span class="math notranslate nohighlight">\(k\)</span> ìš”ì¸ì˜ ê´€ê³„ í–‰ë ¬</p></li>
<li><p><span class="math notranslate nohighlight">\(Q \in \mathbf{R}^{n \times k}\)</span> : <span class="math notranslate nohighlight">\(n\)</span> ìƒí’ˆì˜ì™€ <span class="math notranslate nohighlight">\(k\)</span> ìš”ì¸ì˜ ê´€ê³„ í–‰ë ¬</p></li>
</ul>
</div>
<div class="section" id="svd-singular-value-decomposition">
<h2>SVD (Singular Value Decomposition)<a class="headerlink" href="#svd-singular-value-decomposition" title="Permalink to this headline">Â¶</a></h2>
<p>SVD (Singular Value Decomposition) ëŠ” Matrix Factorization ë¬¸ì œë¥¼ í‘¸ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ì´ë‹¤.</p>
<p><span class="math notranslate nohighlight">\(m \times n\)</span> í¬ê¸°ì˜ í–‰ë ¬ <span class="math notranslate nohighlight">\(R\)</span>ì€ ë‹¤ìŒê³¼ ê°™ì´ ì„¸ í–‰ë ¬ì˜ ê³±ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤. ì´ë¥¼ íŠ¹ì´ì¹˜ ë¶„í•´(Singular Value Decomposition) ë¼ê³  í•œë‹«.</p>
<div class="math notranslate nohighlight">
\[ R =  U \Sigma V^T \]</div>
<p>ì´ ì‹ì—ì„œ</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(U\)</span> ëŠ” <span class="math notranslate nohighlight">\(m \times m\)</span> í¬ê¸°ì˜ í–‰ë ¬ë¡œ ì—­í–‰ë ¬ì´ ëŒ€ì¹­ í–‰ë ¬</p></li>
<li><p><span class="math notranslate nohighlight">\(\Sigma\)</span> ëŠ” <span class="math notranslate nohighlight">\(m \times n\)</span> í¬ê¸°ì˜ í–‰ë ¬ë¡œ ë¹„ëŒ€ê° ì„±ë¶„ì´ 0</p></li>
<li><p><span class="math notranslate nohighlight">\(V\)</span> ëŠ” <span class="math notranslate nohighlight">\(n \times n\)</span> í¬ê¸°ì˜ í–‰ë ¬ë¡œ ì—­í–‰ë ¬ì´ ëŒ€ì¹­ í–‰ë ¬</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\Sigma\)</span>ì˜ ëŒ€ê° ì„±ë¶„ì€ íŠ¹ì´ì¹˜ë¼ê³  í•˜ë©° ì „ì²´ íŠ¹ì´ì¹˜ ì¤‘ì—ì„œ ê°€ì¥ ê°’ì´ í° <span class="math notranslate nohighlight">\(k\)</span>ê°œì˜ íŠ¹ì´ì¹˜ë§Œì„ ì‚¬ìš©í•˜ì—¬ (Truncated SVD), ë‹¤ìŒê³¼ ê°™ì€ í–‰ë ¬ì„ ë§Œë“¤ìˆ˜ ìˆë‹¤.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{U}\)</span> ëŠ” <span class="math notranslate nohighlight">\(U\)</span>ì—ì„œ ê°€ì¥ ê°’ì´ í° <span class="math notranslate nohighlight">\(k\)</span>ê°œì˜ íŠ¹ì´ì¹˜ì— ëŒ€ì‘í•˜ëŠ” <span class="math notranslate nohighlight">\(k\)</span>ê°œì˜ ì„±ë¶„ë§Œì„ ë‚¨ê¸´ <span class="math notranslate nohighlight">\(m \times k\)</span> í¬ê¸°ì˜ í–‰ë ¬</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{\Sigma}\)</span> ëŠ” ê°€ì¥ ê°’ì´ í° <span class="math notranslate nohighlight">\(k\)</span>ê°œì˜ íŠ¹ì´ì¹˜ì— ëŒ€ì‘í•˜ëŠ” <span class="math notranslate nohighlight">\(k\)</span>ê°œì˜ ì„±ë¶„ë§Œì„ ë‚¨ê¸´ <span class="math notranslate nohighlight">\(k \times k\)</span> í¬ê¸°ì˜ ëŒ€ê° í–‰ë ¬</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{V}\)</span> ëŠ” <span class="math notranslate nohighlight">\(V\)</span>ì—ì„œ ê°€ì¥ ê°’ì´ í° <span class="math notranslate nohighlight">\(k\)</span>ê°œì˜ íŠ¹ì´ì¹˜ì— ëŒ€ì‘í•˜ëŠ” <span class="math notranslate nohighlight">\(k\)</span>ê°œì˜ ì„±ë¶„ë§Œì„ ë‚¨ê¸´ <span class="math notranslate nohighlight">\(k \times n\)</span> í¬ê¸°ì˜ í–‰ë ¬</p></li>
</ul>
<p>ì´ í–‰ë ¬ì„ ë‹¤ì‹œ ì¡°í•©í•˜ë©´ ì›ë˜ì˜ í–‰ë ¬ê³¼ ê°™ì€ í¬ê¸°ë¥¼ ê°€ì§€ê³  ìœ ì‚¬í•œ ì›ì†Œë¥¼ ê°€ì§€ëŠ” í–‰ë ¬ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</p>
<div class="math notranslate nohighlight">
\[ \hat{U} \hat{\Sigma} \hat{V}^T =  \hat{R} \approx R \]</div>
<p>í•˜ì§€ë§Œ ì‹¤ì œë¡œ í‰ì  í–‰ë ¬ì€ ë¹ˆ ì›ì†Œê°€ ë§ì€ sparse í–‰ë ¬ë¡œì„œ SVDë¥¼ ë°”ë¡œ ì ìš©í•˜ê¸° í˜ë“¤ê¸° ë•Œë¬¸ì—  í–‰ë ¬ <span class="math notranslate nohighlight">\(P\)</span>, <span class="math notranslate nohighlight">\(Q\)</span>ëŠ”  ë‹¤ìŒê³¼ ê°™ì€ ëª¨í˜•ì— ëŒ€í•´  ì˜¤ì°¨ í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ì—¬ êµ¬í•œë‹¤.</p>
<div class="math notranslate nohighlight">
\[ 
\hat{r}(u,i) = \mu + b(u) + b(i) + q(i)^Tp(u) 
\]</div>
<div class="math notranslate nohighlight">
\[ 
\sum_{u,i \in R_{train}} \left(r(u,i) - \hat{r}(u,i) \right)^2 +
\lambda\left(b(i)^2 + b(u)^2 + ||q(i)||^2 + ||p(u)||^2\right) 
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">surprise</span><span class="o">.</span><span class="n">SVD</span><span class="p">(</span><span class="n">n_factors</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">cross_validate</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="s2">&quot;test_mae&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 30.4 s, sys: 50 ms, total: 30.4 s
Wall time: 30.5 s
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.739210803693828
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="nmf-non-negative-matrix-factorization">
<h2>NMF(Non-negative matrix factorization)<a class="headerlink" href="#nmf-non-negative-matrix-factorization" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">surprise</span><span class="o">.</span><span class="n">NMF</span><span class="p">(</span><span class="n">n_factors</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">cross_validate</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="s2">&quot;test_mae&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 24s, sys: 330 ms, total: 1min 24s
Wall time: 1min 25s
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8371368390504086
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./03 machine learning"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="06.05 ì •ê·œí™” ì„ í˜•íšŒê·€.html" title="previous page">6.5 ì •ê·œí™” ì„ í˜•íšŒê·€</a>
    <a class='right-next' id="next-link" href="09.01 ë¶„ë¥˜ìš© ì˜ˆì œ ë°ì´í„°.html" title="next page">5.1 ë¶„ë¥˜ìš© ì˜ˆì œ ë°ì´í„°</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ê¹€ë„í˜•<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>